C:\Users\GodKe\.conda\envs\CudaEnv\python.exe D:\DevelopFolders\PyCharm\CrawlerDetect\src\model.py
使用设备: cuda
加载嵌入器模型...
使用设备: cuda
模型从 models_balanced_strict 加载完成
加载和预处理数据...
尝试从缓存目录 ../dataset/cache 加载数据...
数据集成功从缓存加载！
数据集大小 - 训练: 42151, 验证: 9032, 测试: 9034
开始训练模型...

Epoch 1/20
Training: 100%|████████████████████████| 2635/2635 [01:06<00:00, 39.64it/s, loss=0.2447, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 125.62it/s, loss=0.2821, acc=87.50%]
Train Loss: 0.3166 | Train Acc: 87.20% | Val Loss: 0.2333 | Val Acc: 91.21%
Model saved with accuracy: 91.21%

Epoch 2/20
Training: 100%|████████████████████████| 2635/2635 [01:06<00:00, 39.72it/s, loss=0.1863, acc=85.71%]
Validation: 100%|████████████████████████| 565/565 [00:05<00:00, 95.13it/s, loss=0.5411, acc=87.50%]
Train Loss: 0.2575 | Train Acc: 90.07% | Val Loss: 0.2164 | Val Acc: 91.51%
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Model saved with accuracy: 91.51%

Epoch 3/20
Training: 100%|███████████████████████| 2635/2635 [01:10<00:00, 37.41it/s, loss=0.0612, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 113.26it/s, loss=0.7288, acc=87.50%]
Train Loss: 0.2348 | Train Acc: 91.12% | Val Loss: 0.1948 | Val Acc: 92.87%
Model saved with accuracy: 92.87%

Epoch 4/20
Training: 100%|████████████████████████| 2635/2635 [01:07<00:00, 39.10it/s, loss=0.2378, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 109.00it/s, loss=0.8950, acc=87.50%]
Train Loss: 0.2162 | Train Acc: 91.82% | Val Loss: 0.1844 | Val Acc: 93.70%
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Model saved with accuracy: 93.70%

Epoch 5/20
Training: 100%|███████████████████████| 2635/2635 [01:06<00:00, 39.42it/s, loss=0.0062, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 112.34it/s, loss=0.9117, acc=87.50%]
Train Loss: 0.2029 | Train Acc: 92.67% | Val Loss: 0.1739 | Val Acc: 93.67%

Epoch 6/20
Training: 100%|████████████████████████| 2635/2635 [01:04<00:00, 41.06it/s, loss=0.2282, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 122.49it/s, loss=0.9692, acc=87.50%]
Train Loss: 0.1891 | Train Acc: 93.02% | Val Loss: 0.1589 | Val Acc: 94.45%
Model saved with accuracy: 94.45%

Epoch 7/20
Training: 100%|███████████████████████| 2635/2635 [01:07<00:00, 39.07it/s, loss=0.0144, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 112.58it/s, loss=0.9466, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1840 | Train Acc: 93.48% | Val Loss: 0.1661 | Val Acc: 93.70%

Epoch 8/20
Training: 100%|███████████████████████| 2635/2635 [01:06<00:00, 39.62it/s, loss=0.0747, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 112.30it/s, loss=0.1419, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1777 | Train Acc: 93.69% | Val Loss: 0.1683 | Val Acc: 93.82%

Epoch 9/20
Training: 100%|████████████████████████| 2635/2635 [01:08<00:00, 38.57it/s, loss=0.8778, acc=71.43%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 106.95it/s, loss=0.4907, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1719 | Train Acc: 93.99% | Val Loss: 0.1650 | Val Acc: 94.35%

Epoch 10/20
Training: 100%|███████████████████████| 2635/2635 [01:08<00:00, 38.67it/s, loss=0.0178, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 113.41it/s, loss=0.1954, acc=87.50%]
Train Loss: 0.1677 | Train Acc: 94.21% | Val Loss: 0.1566 | Val Acc: 94.59%
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Model saved with accuracy: 94.59%

Epoch 11/20
Training: 100%|███████████████████████| 2635/2635 [01:06<00:00, 39.33it/s, loss=0.0723, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 108.21it/s, loss=0.6342, acc=87.50%]
Train Loss: 0.1603 | Train Acc: 94.32% | Val Loss: 0.1499 | Val Acc: 94.79%
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Model saved with accuracy: 94.79%

Epoch 12/20
Training: 100%|███████████████████████| 2635/2635 [01:08<00:00, 38.54it/s, loss=0.0368, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 110.92it/s, loss=0.3029, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1598 | Train Acc: 94.29% | Val Loss: 0.1554 | Val Acc: 94.30%

Epoch 13/20
Training: 100%|███████████████████████| 2635/2635 [01:04<00:00, 40.94it/s, loss=0.0120, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 114.40it/s, loss=0.2717, acc=87.50%]
Train Loss: 0.1559 | Train Acc: 94.42% | Val Loss: 0.1528 | Val Acc: 95.04%
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Model saved with accuracy: 95.04%

Epoch 14/20
Training: 100%|███████████████████████| 2635/2635 [01:08<00:00, 38.53it/s, loss=0.0515, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 101.95it/s, loss=0.3276, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1528 | Train Acc: 94.60% | Val Loss: 0.1552 | Val Acc: 94.49%

Epoch 15/20
Training: 100%|███████████████████████| 2635/2635 [01:06<00:00, 39.64it/s, loss=0.1375, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 109.58it/s, loss=0.4563, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1497 | Train Acc: 94.69% | Val Loss: 0.1497 | Val Acc: 94.79%

Epoch 16/20
Training: 100%|████████████████████████| 2635/2635 [01:05<00:00, 40.44it/s, loss=1.1958, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 117.83it/s, loss=0.4275, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1469 | Train Acc: 94.65% | Val Loss: 0.1613 | Val Acc: 94.46%

Epoch 17/20
Training: 100%|███████████████████████| 2635/2635 [01:03<00:00, 41.31it/s, loss=0.0187, acc=100.00%]
Validation: 100%|███████████████████████| 565/565 [00:05<00:00, 105.23it/s, loss=0.5126, acc=87.50%]
Train Loss: 0.1441 | Train Acc: 94.72% | Val Loss: 0.1556 | Val Acc: 94.73%

Epoch 18/20
Training: 100%|████████████████████████| 2635/2635 [01:07<00:00, 39.16it/s, loss=0.5663, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 118.79it/s, loss=0.2566, acc=87.50%]
Train Loss: 0.1402 | Train Acc: 94.91% | Val Loss: 0.1509 | Val Acc: 95.05%
Model saved with accuracy: 95.05%

Epoch 19/20
Training: 100%|████████████████████████| 2635/2635 [01:06<00:00, 39.60it/s, loss=0.3496, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 113.61it/s, loss=0.6541, acc=87.50%]
Training:   0%|                                                            | 0/2635 [00:00<?, ?it/s]Train Loss: 0.1379 | Train Acc: 94.82% | Val Loss: 0.1577 | Val Acc: 94.94%

Epoch 20/20
Training: 100%|████████████████████████| 2635/2635 [01:06<00:00, 39.61it/s, loss=0.2385, acc=85.71%]
Validation: 100%|███████████████████████| 565/565 [00:04<00:00, 113.46it/s, loss=0.4604, acc=87.50%]
Evaluating model:   0%|          | 0/565 [00:00<?, ?it/s, acc=100.00%]Train Loss: 0.1248 | Train Acc: 95.24% | Val Loss: 0.1560 | Val Acc: 94.85%
进行详细模型评估...
使用中文字体: C:/Windows/Fonts/simhei.ttf
Evaluating model: 100%|██████████| 565/565 [00:05<00:00, 111.12it/s, acc=80.00%]
测试准确率: 94.66%

分类报告:
              precision    recall  f1-score   support

       human       0.95      0.98      0.96      6177
         bot       0.94      0.89      0.91      2857

    accuracy                           0.95      9034
   macro avg       0.95      0.93      0.94      9034
weighted avg       0.95      0.95      0.95      9034


混淆矩阵:
[[6023  154]
 [ 328 2529]]

ROC AUC: 0.9806
平均精度分数: 0.9703
评估报告和可视化结果已保存至 evaluation_results_strict_large
最终测试准确率: 94.66%
ROC AUC: 0.9806
平均精度: 0.9703

进程已结束，退出代码为 0